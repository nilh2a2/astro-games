---
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import getGamePath from "@/utils/getGamePath";
import { getCategoryLabel } from "@/utils/getCategoryLabels";

type Props = CollectionEntry<"games">;

const game = Astro.props;
const { title, description, thumbnail, category, rating } = game.data;
const gamePath = getGamePath(game);
---

<a href={gamePath} class="group block rounded-lg border-2 border-skin-line bg-skin-card transition-all hover:border-skin-accent overflow-hidden">
  <div class="flex gap-3 p-3">
    <div class="relative flex-shrink-0 w-20 h-16 overflow-hidden rounded bg-skin-accent/10">
      {thumbnail ? (
        <Image
          src={thumbnail}
          alt={title}
          class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-110"
          loading="lazy"
        />
      ) : (
        <div class="flex h-full w-full items-center justify-center bg-gradient-to-br from-skin-accent/20 to-skin-accent/5">
          <svg class="h-6 w-6 text-skin-accent/50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
      )}
    </div>
    <div class="flex-1 min-w-0">
      <h3 class="mb-1 line-clamp-2 text-sm font-bold text-skin-base leading-tight">
        {title}
      </h3>
      <div class="flex items-center gap-2 text-xs text-skin-base/60">
        <span>{getCategoryLabel(category)}</span>
        {rating && (
          <span class="flex items-center gap-1">
            <svg class="h-3 w-3 fill-yellow-500" viewBox="0 0 20 20">
              <path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z" />
            </svg>
            {rating.toFixed(1)}
          </span>
        )}
      </div>
    </div>
  </div>
</a>
